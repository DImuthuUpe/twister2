# Tera Sort

## Introduction

Tera Sort is a common benchmark to measure and compare high performance big data frameworks such as Twister2. The idea is to measure the time to sort one terabyte of randomly distributed data.

In twister2, we generate a batch of tuples, each having a random integer as the key and a byte array of configurable length as the value. These tuples will be sent from multiple sources to a single sinks with keyed gather operation applied as the connection. Keyed Gather operation is configured with a comparator to sort by key. 

Tera sort benchmark can be spawned as follows.

```./bin/twister2 submit standalone jar examples/libexamples-java.jar edu.iu.dsc.tws.examples.task.batch.sort.TeraSort -size 1 -valueSize 90 -keyRange 10000 -instances 4 -instanceCpus 1 -instanceMemory 512 -sources 4```

### Tera Sort parameters

#### Data Configuration

| Parameter  | Description | Default Value |
| ------------- | ------------- | ------------- |
| size  | Size of data generated by a single source. In twister2 terasort, we will be always using a random int as the key. The number of tuples generated by a single source will be determined as, (valueSize + 8)/size  | Mandatory |
| valueSize | Size of the value component of the tuple | Mandatory |
| keyRange | Upper bound for the key range | Mandatory |

#### Resource Configuration

| Parameter  | Description | Default Value |
| ------------- | ------------- | ------------- |
| instances | No of twister2 worker instances | Mandatory |
| instanceCpus | No of CPUs to allocate per each instance(Might not be applicable for all twister2 modes) | Mandatory |
| instanceMemory | Amount of memory to allocate in MB for each instance | Mandatory |
| sources | No. of sources to generate data. This will multiply the data size of your current configuration. For example, if you have specified, 512GB as the data size and 4 as the No. of sources, twister2 will produce and sort 1TB of data in total | Mandatory |

#### Tuneup Parameters

| Parameter  | Description | Default Value |
| ------------- | ------------- | ------------- |
| memoryBytes | Maximum amount of random access memory(in bytes) to utilize to hold incoming tuples. Tuples will be written to the disk, once this limit is exceeded. | 6400 |
| memoryRecords | Maximum amount of tuples to keep in RAM. | 64 |
