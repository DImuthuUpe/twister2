<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Windowing API · Twister2</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Twister2 Streaming API supports the discretization of a data stream via windowing.&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Windowing API · Twister2"/><meta property="og:type" content="website"/><meta property="og:url" content="https://twister2.org/"/><meta property="og:description" content="&lt;p&gt;Twister2 Streaming API supports the discretization of a data stream via windowing.&lt;/p&gt;
"/><meta property="og:image" content="https://twister2.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://twister2.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://twister2.org/blog/atom.xml" title="Twister2 Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://twister2.org/blog/feed.xml" title="Twister2 Blog RSS Feed"/><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat|Oswald|Roboto&amp;display=swap"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo_large.png" alt="Twister2"/><h2 class="headerTitleWithLogo">Twister2</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/docs/download" target="_self">Download</a></li><li class=""><a href="http://twister2.org" target="_self">GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>App Development</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/introduction">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/download">Download</a></li><li class="navListItem"><a class="navItem" href="/docs/quickstart">Quickstart</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Compiling</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/compiling/compile_overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/compiling/linux">Linux</a></li><li class="navListItem"><a class="navItem" href="/docs/compiling/macos">MacOS</a></li><li class="navListItem"><a class="navItem" href="/docs/compiling/generate-maven">Maven Artifacts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">App Development</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/concepts/api_overview">API Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/developing_twister2">Developing Applications</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/tset_api">TSet API</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/task_api">Task API</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/op_api">Operator API</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/concepts/windowing/windowing_api">Windowing API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Deployment</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/deployment/docker/docker">Docker</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/kubernetes/kubernetes">Kubernetes</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/mesos/mesos">Mesos</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/slurm/slurm">Slurm</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/standalone/standalone">Standalone</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/job-submit">Job Submit</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/dashboard">Dashboard</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment/logging">Logging</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Concepts</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/concepts/concepts">Concepts</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/distributed_runtime">Distributed Runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/par_ops">Operators</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/task-system/concept_task">Task System</a></li><li class="navListItem"><a class="navItem" href="/docs/concepts/data-access/data_access">Data Access</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Examples</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/examples/wordcount/wordcount">Word Count</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/collectives/comms/comm">Operators</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/collectives/task/task">Task</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/benchmark/benchmark">Benchmark</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/joins/join">Join</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/terasort/terasort">Tera Sort</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/windowing/windowing">Windowing</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/ml/kmeans/kmeans">K-Means</a></li><li class="navListItem"><a class="navItem" href="/docs/examples/ml/svm/svm">SVM</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Developer Resources</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/developers/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/developers/devenv">IDE&#x27;s</a></li><li class="navListItem"><a class="navItem" href="/docs/developers/faq">FAQ</a></li><li class="navListItem"><a class="navItem" href="/docs/developers/tests">Unit Tests</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Community</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/community/contributing">Contributing</a></li><li class="navListItem"><a class="navItem" href="/docs/community/mailing">Mailing Lists</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Versions</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/release/versions">Versions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Publications</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/publications">Publications</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Windowing API</h1></header><article><div><span><p>Twister2 Streaming API supports the discretization of a data stream via windowing.
Our Windowing API was developed supporting functionalities in Apache Storm and Apache Flink.
The core API has inherent features of Apache Storm API. Our windowing API definitions are
derived from the industry standards maintained by Apache Storm and Apache Flink APIs.
The windowing categorization can be found in the following figure. In streaming engines like
Apache Flink, the key based and non-key based support is discussed for windowing, but in Twister2
we have inbuilt communication functions built for keyed and non-keyed operations. So when user is
creating a workflow, it can be created using keyed or non-keyed streaming pipelines.</p>
<p><img src="/docs/assets/windowing-flow.png" alt="The Tree of Windowing" title="Title"></p>
<hr>
<p><strong>NOTE</strong></p>
<p>The gray colored boxes with Global and Session Window support is not yet provided in Twister2.</p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="window-types"></a><a href="#window-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Window Types</h2>
<h3><a class="anchor" aria-hidden="true" id="tumbling"></a><a href="#tumbling" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tumbling</h3>
<p>Tumbling windowing is a fixed size window where the elements belonging to a particular
window only belong to that window only. There is no repetition of these elements. This is
also known as fixed windows.</p>
<p>For example, you can say you need to collect 4 elements per window and this can be a window
based on the number of elements per window.</p>
<p><img src="/docs/assets/tumbling-count-window-1.png" alt="Count Based Tumbling Window"></p>
<pre><code class="hljs css language-java">    BaseWindowedSink dw = <span class="hljs-keyword">new</span> DirectWindowedReceivingTask()
        .withTumblingCountWindow(<span class="hljs-number">4</span>);
</code></pre>
<p>The other way is that you can say, you need to collect some elements per every 2 minutes.</p>
<p><img src="/docs/assets/tumbling-duration-window-1.png" alt="Duration Based Tumbling Window"></p>
<pre><code class="hljs css language-java">    BaseWindowedSink dwDuration = <span class="hljs-keyword">new</span> DirectWindowedReceivingTask()
        .withTumblingDurationWindow(<span class="hljs-number">2</span>, TimeUnit.MINUTES);

</code></pre>
<p>These are the ways that you can create a tumbling window, based on time and based on the count.</p>
<h3><a class="anchor" aria-hidden="true" id="sliding"></a><a href="#sliding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sliding</h3>
<p>Sliding window has two properties, sliding length and window length. Sliding length can be lesser
than the window length. This can be present in terms of both count and duration.</p>
<p>For example, you can say you need to collect 4 elements per window and this can be a window
based on the number of elements per window.</p>
<p><img src="/docs/assets/sliding-count-window.png" alt="Count Based Tumbling Window"></p>
<pre><code class="hljs css language-java">BaseWindowedSink sdw = <span class="hljs-keyword">new</span> DirectWindowedReceivingTask()
        .withSlidingCountWindow(<span class="hljs-number">4</span>, <span class="hljs-number">2</span>);

</code></pre>
<p>The other way is that you can say, you need to collect some elements per every 2 minutes.</p>
<p><img src="/docs/assets/sliding-duration-window.png" alt="Duration Based Tumbling Window"></p>
<pre><code class="hljs css language-java">    BaseWindowedSink sdwDuration = <span class="hljs-keyword">new</span> DirectWindowedReceivingTask()
        .withSlidingDurationWindow(<span class="hljs-number">4</span>, TimeUnit.MINUTES,
            <span class="hljs-number">2</span>, TimeUnit.MINUTES);
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="session"></a><a href="#session" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Session</h3>
<p>A session window is defined as a window where a presense of an element triggers the window starting,
but the windowing period terminates after a time out. Currently Twister2 doesn't support this
function, but it will be added to the next release.</p>
<h3><a class="anchor" aria-hidden="true" id="global"></a><a href="#global" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Global</h3>
<p>Global window is a definition coming in Apache Flink windowing APIs. It provides the ability to
get same keyed elements to the same window. Twister2 inherent communication APIs can already support
this. You can design your task graph with the specific key selectors to get this done.
But in an upcoming release, Twister2 will provide a programming abstraction at the windowing level
for users to handle this in another way.</p>
<hr>
<p><strong>NOTE</strong></p>
<ol>
<li>Tumbling window is a special instance of a sliding window where the sliding length equals to window
length.</li>
<li>Duration windowing can have windows with no elements, in processing, the filtering functions can
be used to avoid issues in calculations or we can design custom policies to manage it. This will be
further discussed in Windowing policies, eviction policies and strategy sections.</li>
</ol>
<hr>
<h2><a class="anchor" aria-hidden="true" id="windowing-policies"></a><a href="#windowing-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windowing Policies</h2>
<p>Windowing Policies are basically designed to create a dynamic design pattern to provide custom
policy addition capability. For these policy definitions Twister2 uses Apache Storm windowing policy
definitions to support windowing. Windowing policy decides how the boundary of the window is identified
by means of the elements for count based and in terms of watermark or timer for duration based
windows. These are the main types of windowing policies we supports.</p>
<ol>
<li>Count Windowing Policy</li>
<li>Duration Windowing Policy</li>
<li>Watermark Count Windowing Policy</li>
<li>Watermark Duration Windowing Policy</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="eviction-policies"></a><a href="#eviction-policies" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Eviction Policies</h2>
<p>Eviction policy provides support to the windowing policy to identify the boundary specially for the
duration based and watermark based policies.</p>
<ol>
<li>Count Eviction Policy</li>
<li>Duration Eviction Policy</li>
<li>Watermark Count Eviction Policy</li>
<li>Watermark Duration Eviction Policy</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="windowing-strategy"></a><a href="#windowing-strategy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windowing Strategy</h2>
<p>Windowing strategy is an abstraction layer of Eviction and Windowing policies where user can
create custom strategies to design a windowing mechanism. Currently, Twister2 supports the following
strategies.</p>
<ol>
<li>Tumbling Count Window Strategy</li>
<li>Tumbling Duration Window Strategy</li>
<li>Sliding Count Window Strategy</li>
<li>Sliding Duration Window Strategy</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="window-function"></a><a href="#window-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Window Function</h2>
<p>Windowing functionality is a function provided for the user to design their programming logic
which has to be executed on the window. We followed the standards defined in Apache Flink to provide
similar functionalities.</p>
<h3><a class="anchor" aria-hidden="true" id="reduce-function"></a><a href="#reduce-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reduce Function</h3>
<p>User can design a custom reduce function on top of the window and the logic defined in the reduce
function will be applied on the elements inside the window.</p>
<pre><code class="hljs css language-java">protected static class DirectReduceWindowedTask extends ReduceWindow&lt;int[]&gt; {


    public DirectReduceWindowedTask(ReduceWindowedFunction&lt;int[]&gt; reduceWindowedFunction) {
      super(reduceWindowedFunction);
    }

    @Override
    public boolean reduce(int[] content) {
      LOG.info("Window Reduced Value : " + Arrays.toString(content));
      return true;
    }

    @Override
    public boolean reduceLateMessage(int[] content) {
      return false;
    }

  }
</code></pre>
<pre><code class="hljs css language-java">protected static class ReduceFunctionImpl implements ReduceWindowedFunction&lt;int[]&gt; {

    @Override
    public int[] onMessage(int[] object1, int[] object2) {
      int[] ans = new int[object1.length];
      for (int i = 0; i &lt; object1.length; i++) {
        ans[i] = object1[i] + object2[i];
      }
      return ans;
    }

    @Override
    public int[] reduceLateMessage(int[] lateMessage) {
      return new int[0];
    }
  }
</code></pre>
<pre><code class="hljs css language-java">BaseWindowedSink sdwCountTumblingReduce = <span class="hljs-keyword">new</span> DirectReduceWindowedTask(<span class="hljs-keyword">new</span> ReduceFunctionImpl())
        .withTumblingCountWindow(<span class="hljs-number">5</span>);
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="aggregation-function"></a><a href="#aggregation-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Aggregation Function</h3>
<p>Aggregation of windowed values is another functionality user needs when processing the window.</p>
<pre><code class="hljs css language-java"> protected static class DirectAggregateWindowedTask extends AggregateWindow&lt;int[]&gt; {

    public DirectAggregateWindowedTask(AggregateWindowedFunction aggregateWindowedFunction) {
      super(aggregateWindowedFunction);
    }

    @Override
    public boolean aggregate(int[] message) {
      LOG.info("Window Aggregate Value : " + Arrays.toString(message));
      return true;
    }

    @Override
    public boolean aggregateLateMessages(int[] message) {
      LOG.info(String.format("Late Aggregate Message : %s", Arrays.toString(message)));
      return true;
    }
  }
</code></pre>
<pre><code class="hljs css language-java">protected static class AggregateFunctionImpl implements AggregateWindowedFunction&lt;int[]&gt; {

    private int weight1;

    private int weight2;

    public AggregateFunctionImpl(int weight1, int weight2) {
      this.weight1 = weight1;
      this.weight2 = weight2;
    }

    @Override
    public int[] onMessage(int[] object1, int[] object2) {
      int[] ans = new int[object1.length];
      for (int i = 0; i &lt; object1.length; i++) {
        ans[i] = this.weight1 * object1[i] + this.weight2 * object2[i];
      }
      return ans;
    }
  }
</code></pre>
<pre><code class="hljs css language-java">BaseWindowedSink sdwCountTumblingAggregate
        = <span class="hljs-keyword">new</span> STWindowExample
        .DirectAggregateWindowedTask(<span class="hljs-keyword">new</span> AggregateFunctionImpl(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>))
        .withTumblingCountWindow(<span class="hljs-number">5</span>);
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="fold-function"></a><a href="#fold-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Fold Function</h3>
<p>Fold function provides the user the ability to get a different data typed or same data typed
output from the data type in the window. This is more likely to help in creating summaries or
creating and output to support a different function or API which needs a different data type.</p>
<pre><code class="hljs css language-java">protected static class DirectFoldWindowedTask extends FoldWindow&lt;int[], String&gt; {

    public DirectFoldWindowedTask(FoldWindowedFunction&lt;int[], String&gt; foldWindowedFunction) {
      super(foldWindowedFunction);
    }

    @Override
    public boolean fold(String content) {
      LOG.info("Window Fold Value : " + content);
      return true;
    }

    @Override
    public boolean foldLateMessage(String lateMessage) {
      LOG.info(String.format("Late Aggregate Message : %s", lateMessage));
      return false;
    }
  }

</code></pre>
<pre><code class="hljs css language-java">protected static class DirectFoldWindowedTask extends FoldWindow&lt;int[], String&gt; {

    public DirectFoldWindowedTask(FoldWindowedFunction&lt;int[], String&gt; foldWindowedFunction) {
      super(foldWindowedFunction);
    }

    @Override
    public boolean fold(String content) {
      LOG.info("Window Fold Value : " + content);
      return true;
    }

    @Override
    public boolean foldLateMessage(String lateMessage) {
      LOG.info(String.format("Late Aggregate Message : %s", lateMessage));
      return false;
    }
  }
</code></pre>
<pre><code class="hljs css language-java">BaseWindowedSink sdwCountTumblingFold = <span class="hljs-keyword">new</span> DirectFoldWindowedTask(<span class="hljs-keyword">new</span> FoldFunctionImpl())
        .withTumblingCountWindow(<span class="hljs-number">5</span>);

</code></pre>
<h3><a class="anchor" aria-hidden="true" id="window-process-function"></a><a href="#window-process-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Window Process Function</h3>
<p>Process function provides you the ability to get the same elements of the window, but you can
apply a custom function on each element. This is also a different use case that use may need when
providing data to different APIs.</p>
<pre><code class="hljs css language-java">protected static class DirectProcessWindowedTask extends ProcessWindow&lt;int[]&gt; {

    public DirectProcessWindowedTask(ProcessWindowedFunction&lt;int[]&gt; processWindowedFunction) {
      super(processWindowedFunction);
    }

    @Override
    public boolean process(IWindowMessage&lt;int[]&gt; windowMessage) {
      for (IMessage&lt;int[]&gt; msg : windowMessage.getWindow()) {
        int[] msgC = msg.getContent();
        LOG.info("Process Window Value : " + Arrays.toString(msgC));
      }
      return true;
    }

    @Override
    public boolean processLateMessages(IMessage&lt;int[]&gt; lateMessage) {
      LOG.info(String.format("Late Message : %s",
          lateMessage.getContent() != null ? Arrays.toString(lateMessage.getContent()) : "null"));
      return true;
    }
  }
</code></pre>
<pre><code class="hljs css language-java"> protected static class ProcessFunctionImpl implements ProcessWindowedFunction&lt;int[]&gt; {

    @Override
    public IWindowMessage&lt;int[]&gt; process(IWindowMessage&lt;int[]&gt; windowMessage) {
      int[] current = null;
      List&lt;IMessage&lt;int[]&gt;&gt; messages = new ArrayList&lt;&gt;(windowMessage.getWindow().size());
      for (IMessage&lt;int[]&gt; msg : windowMessage.getWindow()) {
        int[] value = msg.getContent();
        if (current == null) {
          current = value;
        } else {
          current = add(current, value);
          messages.add(new TaskMessage&lt;&gt;(current));
        }

      }
      WindowMessageImpl&lt;int[]&gt; windowMessage1 = new WindowMessageImpl&lt;&gt;(messages);
      return windowMessage1;
    }

    @Override
    public IMessage&lt;int[]&gt; processLateMessage(IMessage&lt;int[]&gt; lateMessage) {
      int[] res = lateMessage.getContent();
      if (res != null) {
        for (int i = 0; i &lt; res.length; i++) {
          res[i] = res[i];
        }
      }
      return new TaskMessage&lt;&gt;(res);
    }

    @Override
    public int[] onMessage(int[] object1, int[] object2) {
      if (object1 != null &amp;&amp; object2 != null) {
        return add(object1, object2);
      }
      return null;
    }

    private int[] add(int[] a1, int[] a2) {
      int[] ans = new int[a1.length];
      for (int i = 0; i &lt; a1.length; i++) {
        ans[i] = a1[i] + a2[i];
      }
      return ans;
    }
  }
</code></pre>
<pre><code class="hljs css language-java">BaseWindowedSink sdwCountTumblingProcess
        = <span class="hljs-keyword">new</span> DirectProcessWindowedTask(<span class="hljs-keyword">new</span> ProcessFunctionImpl())
        .withSlidingDurationWindow(<span class="hljs-number">5</span>, TimeUnit.MILLISECONDS, <span class="hljs-number">3</span>,
            TimeUnit.MILLISECONDS);
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="late-stream-processing"></a><a href="#late-stream-processing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Late Stream Processing</h2>
<p>For the late elements which are coming in the stream, Twister2 currently provides a separate function
call which is being called once a late element is coming via the stream. For all the functions defined
in the previous section a late message call is provided.</p>
<pre><code class="hljs css language-java"><span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">processLateMessages</span><span class="hljs-params">(IMessage&lt;<span class="hljs-keyword">int</span>[]&gt; lateMessage)</span> </span>{
      LOG.info(String.format(<span class="hljs-string">"Late Message : %s"</span>,
          lateMessage.getContent() != <span class="hljs-keyword">null</span> ? Arrays.toString(lateMessage.getContent()) : <span class="hljs-string">"null"</span>));
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
</code></pre>
<p>Here  you can design your logic to process a late arriving element.</p>
<h3><a class="anchor" aria-hidden="true" id="late-stream"></a><a href="#late-stream" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Late Stream</h3>
<p>Twister2 will provide a late stream in an upcoming release to link this late coming data to a batch
layer so that the accuracy of the system can be improved.</p>
<h2><a class="anchor" aria-hidden="true" id="future-implementations"></a><a href="#future-implementations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Future Implementations</h2>
<ol>
<li>Global windowing</li>
<li>Session windowing</li>
<li>Late Stream</li>
</ol>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/concepts/op_api"><span class="arrow-prev">← </span><span>Operator API</span></a><a class="docs-next button" href="/docs/deployment/docker/docker"><span>Docker</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#window-types">Window Types</a><ul class="toc-headings"><li><a href="#tumbling">Tumbling</a></li><li><a href="#sliding">Sliding</a></li><li><a href="#session">Session</a></li><li><a href="#global">Global</a></li></ul></li><li><a href="#windowing-policies">Windowing Policies</a></li><li><a href="#eviction-policies">Eviction Policies</a></li><li><a href="#windowing-strategy">Windowing Strategy</a></li><li><a href="#window-function">Window Function</a><ul class="toc-headings"><li><a href="#reduce-function">Reduce Function</a></li><li><a href="#aggregation-function">Aggregation Function</a></li><li><a href="#fold-function">Fold Function</a></li><li><a href="#window-process-function">Window Process Function</a></li></ul></li><li><a href="#late-stream-processing">Late Stream Processing</a><ul class="toc-headings"><li><a href="#late-stream">Late Stream</a></li></ul></li><li><a href="#future-implementations">Future Implementations</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo_large.png" alt="Twister2" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/quickstart.html">Getting Started (Quickstart)</a><a href="/docs/en/developing_twister2.html">Guides (Programming Guides)</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://dsc-twister.slack.com/">Project Chat</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/DSC-SPIDAL/twister2">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Indiana University</section></footer></div></body></html>