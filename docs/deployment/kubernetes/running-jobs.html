<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>deployment/kubernetes/running-jobs · Twister2</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Running Jobs"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="deployment/kubernetes/running-jobs · Twister2"/><meta property="og:type" content="website"/><meta property="og:url" content="https://twister2.org/"/><meta property="og:description" content="# Running Jobs"/><meta property="og:image" content="https://twister2.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://twister2.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="alternate" type="application/atom+xml" href="https://twister2.org/blog/atom.xml" title="Twister2 Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://twister2.org/blog/feed.xml" title="Twister2 Blog RSS Feed"/><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat|Oswald|Roboto&amp;display=swap"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo_large.png" alt="Twister2"/><h2 class="headerTitleWithLogo">Twister2</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/introduction" target="_self">Getting Started</a></li><li class=""><a href="/docs/compiling/compile_overview" target="_self">Docs</a></li><li class=""><a href="/docs/examples/tset/hello_world" target="_self">Tutorial</a></li><li class=""><a href="/docs/developers/debugging" target="_self">Contributors</a></li><li class=""><a href="/configs" target="_self">Configurations</a></li><li class=""><a href="/docs/download" target="_self">Download</a></li><li class=""><a href="https://github.com/DSC-SPIDAL/twister2" target="_blank">GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">deployment/kubernetes/running-jobs</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="running-jobs"></a><a href="#running-jobs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running Jobs</h1>
<p>We assume that you have a running Kubernetes cluster. In your machine, kubectl is configured to talk to Kubernetes master.
You completed <a href="/docs/deployment/kubernetes/Kubernetes">Twister2 installation instructions at Kubernetes clusters</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="running-helloworld-example"></a><a href="#running-helloworld-example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Running HelloWorld Example</h2>
<p>Please first familiarize yourself with <a href="/docs/quickstart">HelloWorld job</a>. You can submit jobs to Kubernetes cluster by using twister2 executable:</p>
<pre><code class="hljs css language-text">./bin/twister2
</code></pre>
<p>When submitting jobs to Kubernetes clusters, you need to specify the cluster name as &quot;kubernetes&quot;. You can submit HelloWorld job in examples package with 8 workers as:</p>
<pre><code class="hljs css language-text">./bin/twister2 submit kubernetes jar examples/libexamples-java.jar edu.iu.dsc.tws.examples.basic.HelloWorld 8
</code></pre>
<p>If there is a problem with job submission, job submission client will exit with a corresponding message printed to the screen. Otherwise, job submission client finishes execution with success.</p>
<h2><a class="anchor" aria-hidden="true" id="job-logs"></a><a href="#job-logs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Job Logs</h2>
<p>You can see the job output either from Kubernetes Dashboard website or persistent logs if enabled.
The workers in HelloWorld job prints a log message and sleeps 1 minutes before exiting.
So the user can check Kubernetes Dashboard website for worker log messages.
There must be a StatefulSet with the job name. List the pods in that StatefulSet.
Check the output for each pod by clicking on the right hand side button. You will see the output for each worker over there.</p>
<p>You can also check the log files from persistent storage if persistent storage is enabled.
As it is explained in the <a href="/docs/deployment/kubernetes/Kubernetes">installation document</a>.</p>
<p>You need to learn the persistent logging directory of your storage provisioner.
You can learn it from Kubernetes Dashboard by checking the provisioner entity or consulting your administrator.
Check that directory for the job logs.</p>
<h2><a class="anchor" aria-hidden="true" id="logs-for-mpi-enabled-jobs"></a><a href="#logs-for-mpi-enabled-jobs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Logs for MPI Enabled Jobs</h2>
<p>The outputs of MPI enabled jobs are a little different in Kubernetes Dashboard.
In those jobs, first worker starts all other workers by using mpirun command.
Therefore, the outputs of all other workers are transferred to the first worker to show on the screen of Kubernetes Dashboard.
So, all outputs from all workers in an MPI enabled job is shown in first worker dashboard.
The dashboards of other workers will only have initialization messages.</p>
<p>However, persistent log files are different. In those files, each worker has its own log messages in its log file.
Therefore, checking log files would be more preferable in MPI enabled jobs compared to checking the dashboard.</p>
<h2><a class="anchor" aria-hidden="true" id="killing-a-twister2-job"></a><a href="#killing-a-twister2-job" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Killing a Twister2 Job</h2>
<p>While some jobs automatically complete when they finish execution (ex: batch jobs),
some other jobs may continually run (ex: streaming jobs). Some jobs may also stuck or take a long time to finish.
If you want to kill a running twister2 job, you can use the following twister2 command with the job name:</p>
<pre><code class="hljs css language-text">./bin/twister2 kill kubernetes <job-name>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="configuration-settings"></a><a href="#configuration-settings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuration Settings</h2>
<p>Configuration files for kubernetes clusters are under the directory:</p>
<pre><code class="hljs css language-text">conf/kubernetes/
</code></pre>
<p>You can specify job related configurations either through client.yaml file or in your job java file by using Twister2Job class methods.
If you specify job parameters in client.yaml file, then you can load them by using following method in your code:</p>
<pre><code class="hljs css language-text">Twister2Job.loadTwister2Job()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="job-names"></a><a href="#job-names" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Job Names</h2>
<p>We are using job names as StatefulSet and Service names. In addition we are using job names as labels.
Therefore job names must follow Kubernetes naming rules: <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names/">Kubernetes resource naming rules</a>.</p>
<p>Job names should consist of lower case alphanumeric characters and dash(-) only. Their length can be 50 chars at most.
If job names do not conform to these rules, we automatically change them to accommodate those rules. We use the changed names as job names.</p>
<h2><a class="anchor" aria-hidden="true" id="modifying-twister2-core-components"></a><a href="#modifying-twister2-core-components" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Modifying Twister2 Core Components</h2>
<p>If you want to modify Twister2 core components, you need to build Twister2 Docker image.
Please consult <a href="/docs/deployment/kubernetes/buiding-docker-image">Building Docker Image for Kubernetes</a></p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#running-helloworld-example">Running HelloWorld Example</a></li><li><a href="#job-logs">Job Logs</a></li><li><a href="#logs-for-mpi-enabled-jobs">Logs for MPI Enabled Jobs</a></li><li><a href="#killing-a-twister2-job">Killing a Twister2 Job</a></li><li><a href="#configuration-settings">Configuration Settings</a></li><li><a href="#job-names">Job Names</a></li><li><a href="#modifying-twister2-core-components">Modifying Twister2 Core Components</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo_large.png" alt="Twister2" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/quickstart.html">Getting Started (Quickstart)</a><a href="/docs/en/concepts/api_overview">Guides (Programming Guides)</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://dsc-twister.slack.com/">Project Chat</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/DSC-SPIDAL/twister2">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Indiana University</section></footer></div></body></html>